using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace PathOfWarForWotR.NewContent.MartialArchetypes
{
    class HiddenBlade
    {
        /*
         * Some rogues specialize in wielding weapons that their enemies will never see, striking from behind veils of shadow and illusion. 
         */
        /*
         * Maneuvers

A hidden blade begins her career with knowledge of three martial maneuvers. The disciplines available to her are Mithral Current, Thrashing Dragon, and Veiled Moon.
Editor's Note: Discipline Exchanges

    Fool's Errand, Mangled Gear, Radiant Dawn, Roaring Mouse, Surging Shark: Any character of any class can access any of these disciplines by trading one of their available disciplines for one of the listed disciplines. If they do, they gain its associated skill as a class skill.

Once the hidden blade knows a maneuver, she must ready it before she can use it (see Maneuvers Readied, below). A maneuver usable by hidden blades is considered an extraordinary ability unless otherwise noted in it or its discipline’s description. A hidden blade’s maneuvers are not affected by spell resistance, and she does not provoke attacks of opportunity when she initiates one.

The hidden blade learns additional maneuvers at higher levels, as indicated on Table: Archetype Maneuver Progression. The maximum level of maneuvers gained through hidden blade levels is limited by those listed in that table as well, although this restriction does not apply to maneuvers added to her maneuvers known through other methods, such as prestige classes or the Advanced Study feat. A hidden blade must meet a maneuver’s prerequisite to learn it. See the Systems and Use chapter in Path of War for more details on how maneuvers are used.

Upon reaching 4th level, and at every even numbered initiator level thereafter (6th, 8th, 10th, and so on), the hidden blade can choose to learn a new maneuver in place of one she already knows. In effect, she loses the old maneuver in exchange for the new one. She can choose a new maneuver of any level she likes, as long as she observes the restriction on the highest-level maneuvers she knows; the hidden blade need not replace the old maneuver with a maneuver of the same level. She can swap only a single maneuver at any given level. A hidden blade’s initiation modifier is Intelligence, and each hidden blade level is counted as a full initiator level.
Maneuvers Readied

A hidden blade can ready all three of her maneuvers known at 1st level, and as she advances in level and learns more maneuvers, she is able to ready more, but must still choose which maneuvers to ready. A hidden blade must always ready her maximum number of maneuvers readied. She readies her maneuvers by meditating or performing martial katas for ten minutes. The maneuvers she chooses remain readied until she decides to meditate again and change them. The hidden blade does not need to sleep or rest for any long period of time in order to ready her maneuvers; any time she spends ten minutes in meditation, she can change her readied maneuvers.

A hidden blade begins an encounter with all her readied maneuvers unexpended, regardless of how many times she might have already used them since she chose them. When she initiates a maneuver, she expends it for the current encounter, so each of her readied maneuvers can be used once per encounter (unless she recovers them, as described below).

In order for the hidden blade to recover maneuvers, she must play a gambit (see below). Alternately, the hidden blade may take a moment to analyze the battlefield, recovering a single maneuver as a standard action.
Stances Known

A hidden blade begins play with knowledge of one stance from any discipline open to hidden blades. At 4th, 7th, 11th, and 13th levels, she can select an additional stance to learn. The maximum level of stances gained through hidden blade levels is limited by those listed in Table: Archetype Maneuver Progression. Unlike maneuvers, stances are not expended and the hidden blade does not have to ready them. All the stances she knows are available to her at all times, and she can change the stance she is currently maintaining as a swift action. A stance is an extraordinary ability unless otherwise stated in the stance or discipline description.

Unlike with maneuvers, a hidden blade cannot learn a new stance at higher levels in place of one she already knows.

This ability replaces the rogue talents gained at 4th, 8th, 12th, 16th and 20th levels. This ability does not cause the hidden blade archetype to be incompatible with other archetypes that alter the rogue talents class feature, so long as it still has a rogue talent at each of these levels to give up.
Hidden Specialization (Ex)

At 1st level, a hidden blade adds Broken Blade, Shattered Mirror, or Tempest Gale to her list of available disciplines. If the hidden blade does not have that discipline’s associated skill as a class skill, she gains it as a class skill.
Hidden Weapons (Ex)

A hidden blade is adept at storing and retrieving weapons from places that no one would expect to find them. At 1st level, she gains Quick Draw as a bonus feat, even if she does not meet the prerequisites. In addition, she can draw hidden weapons as a free action, rather than a move action.
Portable Hole Specialist (Ex)

Starting at 1st level, a hidden blade becomes adept at smuggling and storing objects into and out of extradimensional spaces, and can retrieve items from bags of holding or portable holes as a move action, regardless of how full or unorganized the bag is.
Gambits (Ex)

A hidden blade is a cunning warrior who seizes opportunities as they present themselves to put his enemies in untenable positions. At 1st level, a hidden blade selects two gambits from the gambits available to warlords (see the warlord base class in Path of War) or the hidden blade gambits listed below. At 4th level and every four levels thereafter, a hidden blade selects an additional gambit to learn. Any gambit that would normally use the hidden blade’s Charisma modifier to determine its effects instead uses her hidden blade initiation modifier. These gambits allow the hidden blade to recover maneuvers. Due to their reliance on the stresses of combat to bring out the best of the hidden blade, gambits cannot be used outside combat.

A gambit has two aspects: a risk and a reward. A gambit’s risk describes an action the hidden blade must take in order to play the gambit. The hidden blade begin a gambit as a swift action, then performs the gambit’s risk action. She may add her hidden blade initiation modifier as a luck bonus on any d20 rolls made while performing this action (such as the Acrobatics check of an acrobatic gambit, or the attack roll of a brave gambit). The hidden blade only gets this bonus if she used a swift action to begin the gambit; if taking the actions normally, she gains no additional benefits. If the hidden blade initiates a maneuver as part of a gambit, she cannot recover that maneuver when the gambit is completed (even if it’s her only expended maneuver).

If the hidden blade succeeds at her gambit’s risk, she recovers a number of expended maneuvers equal to her hidden blade initiation modifier (minimum 2) and gains the reward listed in the gambit’s description. Allies who would gain a benefit from the gambit’s reward must be within 60 feet of the hidden blade and able to see her perform the gambit’s risk.

If the hidden blade fails her gambit (such as missing the charge attack of a brave gambit, or failing the saving throw of an unbreakable gambit), she suffers the gambit’s rake, recovering only a single expended maneuver and taking a –2 penalty on all d20 rolls for one round.
Hidden Blade Gambits

Hidden blades can select these gambits in addition to the gambits normally available to warlords. Some of these gambit are supernatural abilities, and do not function in an anti-magic field or similar effect.

Coward’s Gambit

Risk: The hidden blade attacks a flat-footed opponent or an opponent she is flanking.

Reward: The hidden blade’s allies gain a bonus on damage rolls against that opponent equal to the hidden blade’s initiation modifier for one round.

Flanker’s Gambit

Risk: The hidden blade attacks an opponent adjacent to one of the hidden blade’s other allies.

Reward: The hidden blade is considered to be flanking that opponent until the end of her next turn, even if the hidden blade is not in a position that would allow her to flank them.

Stealth Gambit (Su)

Risk: The hidden blade makes a Stealth check to hide.

Reward: The hidden blade becomes invisible for a number of rounds equal to her initiation modifier, as if under the effect of an invisibility spell. 
         */
    }
}
