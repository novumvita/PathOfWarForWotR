using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace TheInfiniteCrusade.NewContent.MartialArchetypes
{
    class FulminantVessel
    {
        /*
         * While most individuals possess the wherewithal and mental conviction to control their animus, not all beings are so fortunate. However, even an unbridled and undisciplined animus user possesses a great deal of power. Fulminant Vessels are beings who have inherited great sources of eldritch power, and use their rage as a method of harnessing their incredible abilities, living volcanoes of arcane energy who tear through everything in their way. 
         */
        /*Maneuvers

A fulminant vessel begins his career with knowledge of five martial maneuvers. The disciplines available to him are Brutal Crocodile, Elemental Flux, Primal Fury, Shattered Mirror, and Spark of Battle. Once the fulminant vessel knows a maneuver, he must ready it before he can use it (see Maneuvers Readied, below). A maneuver usable by a fulminant vessel is considered an extraordinary ability unless otherwise noted in it or its discipline’s description. A fulminant vessel’s maneuvers are not affected by spell resistance, and he does not provoke attacks of opportunity when he initiates one.
Editor's Note: Discipline Exchanges

    Fool's Errand, Mangled Gear, Radiant Dawn, Roaring Mouse, Surging Shark: Any character of any class can access any of these disciplines by trading one of their available disciplines for one of the listed disciplines. If they do, they gain its associated skill as a class skill.

The fulminant vessel learns additional maneuvers at higher levels, as indicated on Table: Animus Archetype Maneuver Progression. The maximum level of maneuvers gained through fulminant vessel levels is limited by those listed in that table as well, although this restriction does not apply to maneuvers added to his maneuvers known through other methods, such as prestige classes or the Advanced Study feat. He must meet a maneuver’s prerequisite to learn it.

Upon reaching 4th level, and at every even numbered initiator level thereafter (6th, 8th, 10th, and so on), the fulminant vessel can choose to learn a new maneuver in place of one he already knows. In effect, he loses the old maneuver in exchange for the new one. He can choose a new maneuver of any level she likes, as long as he observes the restriction on the highest-level maneuvers she knows; the fulminant vessel need not replace the old maneuver with a maneuver of the same level. He can swap only a single maneuver at any given level.

A fulminant vessel’s primary initiator attribute is Charisma.
Maneuvers Readied

A fulminant vessel can ready three of his five maneuvers known at 1st level, and as he advances in level and learns more maneuvers, he is able to ready more, but must still choose which maneuvers to ready. A fulminant vessel must always ready his maximum number of maneuvers readied. He readies his maneuvers by meditating for ten minutes. The maneuvers he chooses remain readied until he decides to meditate again and change them. The fulminant vessel does not need to sleep or rest for any long period of time in order to ready his maneuvers; any time he spends ten minutes in meditation, he can change his readied maneuvers.

A fulminant vessel begins an encounter with all his readied maneuvers unexpended, regardless of how many times he might have already used them since she chose them. When he initiates a maneuver, he expends it for the current encounter, so each of his readied maneuvers can be used once per encounter (unless he recovers them, as described below).

Fulminant vessels rely on surging, unstable planar forces to fuel their martial maneuvers. Because of this, they do not have full control over their readied maneuvers; when a fulminant vessel readies his maneuvers, he selects one of his readied maneuvers to be immediately granted to him for use at any time (when this maneuver is used outside of combat, they recover on their own in the following round), with the rest of his initially randomized maneuvers waiting to be granted in combat. The remainder of his readied maneuvers are withheld and currently inaccessible until combat begins. If he is able to act in a surprise round when combat begins, he is granted his maneuvers then as normal, but if he is caught unaware, he must wait until his initiative before his maneuvers are granted (beyond the initial one). At the end of each of his combat turns, one previously withheld maneuver (randomly determined) is granted to him, and thus becomes accessible for his next turn and subsequent turns. He can freely choose to initiate any maneuver that is currently granted when his turn begins, but he cannot initiate a withheld maneuver. If the fulminant vessel chooses not to employ a maneuver in a given round, his currently granted maneuvers remain available, and a previously withheld maneuver is granted, as described above. In other words, it doesn’t matter if he uses his maneuvers or not—at the end of each of his turns, one withheld maneuver from his selection of readied maneuvers is granted to him. Over the course of a few rounds, all the fulminant vessel’s maneuvers will eventually be granted.

A fulminant vessel can change the readied maneuver he has chosen to be immediately granted for use at any time by spending one minute meditating.

If, at the end of the fulminant vessel’s turn, he cannot be granted a maneuver because he has no withheld maneuvers remaining, he recovers all expended maneuvers, and a new group of readied maneuvers is granted to him, replacing his previously granted maneuvers if any remain unspent. He selects one of his choice (and gains the remainder of granted maneuvers as randomized selections, see below). At the end of his next turn, a withheld maneuver is granted to the fulminant vessel, and the process of surging power begins again.

At 4th level and again at 8th, 12th, 16th, and 20th levels, the number of maneuvers granted to the fulminant vessel at the beginning of an encounter and when he recovers his maneuvers increases by one.

Unlike the fulminant vessel’s initial granted maneuver, these additional maneuvers are randomly determined (for example, at the beginning of an encounter, an 8th level fulminant vessel would choose one maneuver to have access to, then randomly be granted two more).

This ability replaces the bloodrager’s spellcasting.
Stances

Fulminant vessels begin play with knowledge of one stance from any discipline open to them. At 4th, 7th, 11th, and 13th levels, the fulminant vessel selects an additional new stance. Unlike maneuvers, stances are not expended and he does not have to ready them. All the stances he knows are available to him at all times, and he can change the stance he is currently using as a swift action. A stance is an extraordinary ability unless otherwise stated in the stance description.

Unlike with maneuvers, the fulminant vessel cannot learn a new stance at higher levels in place of one he already knows.
Animus (Su)

A fulminant vessel’s martial prowess is in part fueled by a reservoir of roiling, turbulent energy within his soul, and the passion and danger of combat causes this arcane energy to overflow outwards. This power, called animus, waxes and wanes with a fulminant vessel’s use of his maneuvers in battle. Outside combat, a fulminant vessel has no animus to spend, but his inner power can still be used for more subtle arcane arts. His levels in bloodrager count as arcane spellcaster levels for the purposes of qualifying for prerequisites (such as those of item creation feats or the Arcane Strike feat), and if a fulminant vessel ever develops arcane spellcasting from another class, he may add his bloodrager level to his levels in that class to determine his overall caster level for the purposes of item creation feats. In addition, a fulminant vessel is considered to be able to cast bloodrager spells for the purpose of spell trigger and spell completion items, using his initiator level as his caster level.

When a fulminant vessel enters combat, he gains an animus pool equal to his initiation modifier (minimum 1) at the start of his first turn, and adds one point of animus to his animus pool at the start of each of his turns thereafter. His animus pool persists for one minute after the last enemy combatant is defeated or the encounter otherwise ends. At the end of any round in which the fulminant vessel initiates a maneuver (a strike, boost, or counter), he adds an additional point of animus to his pool. Certain abilities, such as some class features, maneuvers, and feats, require the fulminant vessel to expend points of animus to use.

The primal power of animus can be used in several ways—the foremost of which is the augmentation of maneuvers. A fulminant vessel can spend points of animus to augment his maneuvers in the following ways, depending on his class level. If the fulminant vessel has the ability to augment his maneuvers in other ways, such as from another class feature or the maneuver itself, this cannot be combined with the augments granted by his animus class feature; he must choose which augmentation type to use when initiating the maneuver.

Starting at 1st level, a fulminant vessel can spend a single point of animus to augment a maneuver. At 5th level and every 5 levels thereafter, the fulminant vessel may spend an additional point of animus on augments for each maneuver (to a maximum of 5 at 20th level). Animus augments are used as part of a maneuver’s initiation action to apply any of following effects to it (if applicable):

    Enhance Maneuver: For each point of animus spent, the fulminant vessel adds a cumulative +2 insight bonus to all d20 rolls made (including attack rolls, combat maneuver checks, and skill checks) when initiating that maneuver (maximum of three animus may be spent on this augmentation); if the maneuver allows the user to make multiple attacks, then this bonus only applies to the first attack.
    Increase DC: For each point of animus spent, the save DC of that maneuver increases by 1
    Increase Potency: For each point of animus spent, the fulminant vessel may ignore 10 points of energy resistance or 5 points of damage reduction or hardness.

At 8th level, a fulminant vessel gains access the following additional augmentations:

    Animus Form: If the fulminant vessel spends 2 points of animus, they become a raw surging mass of animus for 1 round. While in this state, they become immune to critical hits and sneak attacks and increase any damage reduction and energy resistance they possess to an amount equal to their bloodrager level.
    Restore Rage: For every two points of animus spent, the fulminant vessel gains an additional round of bloodrage.
    Surging Vitality: For every point of animus spent, the fulminant vessel gains temporary hit points equal to half their class level.

At 16th level, a fulminant vessel gains access the following additional augmentations:

    Volcanic Burst: By spending three points of animus, the fulminant vessel may cause his next strike to affect all opponents within a 15-foot cone or 20-foot line. Ranged attacks affect opponents extending from the initiator’s location. The fulminant vessel makes a single attack roll and compares it to the AC of each creature within the area. If the strike allows a saving throw, each target may make one. Only strikes with an initiation action of 1 standard action may be augmented in this fashion, and this augment replaces the strike’s normal targets and affected area.
    Disruptive Blow: If the fulminant vessel spends 4 points of animus, the target (or targets) of the maneuver are affected by Greater Dispel Magic with a caster level equal to the fulminant vessel’s initiator level.
    Explosive Surge: a font of raw arcane power explodes out of the fulminant vessel to a radius of 5 feet for each point of animus spent. Creatures (excluding yourself) within the area take 2d6 points of force damage for every point of animus spent (maximum 10d6), but are allowed a will save to half the damage (DC 10 + half the fulminant vessel’s initiator level + the fulminant vessel’s initiation modifier).

This ability replaces bloodline spells and the bloodline powers gained at 1st, 8th, and 16th levels.
Animus Centering (Su)

As a full-round action, a fulminant vessel can spend one point of animus to grant herself all his remaining withheld maneuvers, then immediately expend them in a raging cadence of arcane power. As there are no remaining maneuvers to be granted, a new set of maneuvers is granted to the fulminant vessel at the end of his turn, as normal.

In addition, when he uses this ability, a fulminant vessel regains one round of bloodrage and immediately ends any fatigue or exhaustion effects which may be affecting him as a result of bloodrage.
Animus Rage (Su)

Starting at 3rd level, a fulminant vessel can enter an amplified form of bloodrage which causes additional animus to accumulate in his form. When entering a bloodrage, the fulminant vessel can choose to enter an animus rage. When he does so, he spends two rounds of bloodrage every round, but acquires two points of animus at the start of each round rather than one.

At 11th level, while in animus rage, the fulminant vessel treats all of their maneuvers as being augmented by 1 point of animus (this is in addition to any animus spent on the maneuver, but the total cannot go beyond the fulminant vessel’s limit of maximum animus augmentation). This increases to 2 points of animus at 20th level.

This ability replaces blood sanctuary as well as the ability to cast spells as a free action when entering greater bloodrage and mighty bloodrage.
Animus Healing (Su)

At 4th level, the fulminant vessel gains Animus Healing as a bonus feat. He can use this ability an additional time per encounter at 8th level and every 4 levels thereafter.

This ability replaces eschew materials.
Raging Spellshield (Su)

At 4th level, the fulminant vessel’s magical form has insulated him against magic. By expending a readied counter as an immediate action, the fulminant vessel may reroll a single saving throw against a spell, spell-like ability, power, or psi-like ability that he just failed.

This ability replaces bloodcasting 
         */
    }
}
