using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace PathOfWarForWotR.NewContent.MartialArchetypes
{
    class SteelValkyr
    {
        /*
         * Across the worlds of multiverse exist armies who fight harder than any other, who stand in impossible odds and fight with undying resolve. Many have postulated where this ability comes from, but the truth for many of these successes lies not in the soldiers themselves but rather the rallying force which lies behind them. These immensely powerful unifiers have become known as the steel valkyr, heralds who merge immense martial skill with the providence of otherworldly magics. 
         */

        /*
         * Class Skills

A steel valkyr adds Survival to his list of class skills.
Maneuvers

A steel valkyr begins his career with knowledge of three martial maneuvers. The disciplines available to him are Brutal Crocodile, Golden Lion, Leaden Hyena, Primal Fury, and Spark of Battle.
Editor's Note: Discipline Exchanges

    Fool's Errand, Mangled Gear, Radiant Dawn, Roaring Mouse, Surging Shark: Any character of any class can access any of these disciplines by trading one of their available disciplines for one of the listed disciplines. If they do, they gain its associated skill as a class skill.

Once the steel valkyr knows a maneuver, he must ready it before he can use it (see Maneuvers Readied, below). A maneuver usable by a steel valkyr is considered an extraordinary ability unless otherwise noted in it or its discipline’s description. A steel valkyr’s maneuvers are not affected by spell resistance, and he does not provoke attacks of opportunity when he initiates one.

The steel valkyr learns additional maneuvers at higher levels, as indicated on Table: Archetype Maneuver Progression. The maximum level of maneuvers gained through steel valkyr levels is limited by those listed in that table as well, although this restriction does not apply to maneuvers added to his maneuvers known through other methods, such as prestige classes or the Advanced Study feat. A steel valkyr must meet a maneuver’s prerequisite to learn it.

Upon reaching 4th level, and at every even numbered initiator level thereafter (6th, 8th, 10th, and so on), the steel valkyr can choose to learn a new maneuver in place of one he already knows. In effect, he loses the old maneuver in exchange for the new one. He can choose a new maneuver of any level he likes, as long as he observes the restriction on the highest-level maneuvers he knows; the steel valkyr need not replace the old maneuver with a maneuver of the same level. He can swap only a single maneuver at any given level.

A steel valkyr’s initiation modifier is Charisma, and each steel valkyr level is counted as a full initiator level.
Maneuvers Readied

A steel valkyr can ready all three of his maneuvers known at 1st level, and as he advances in level and learns more maneuvers, he is able to ready more, but must still choose which maneuvers to ready. A steel valkyr must always ready his maximum number of maneuvers readied. He readies his maneuvers by practicing weapon drills or practicing his songs for ten minutes. The maneuvers he chooses remain readied until he decides to practice again and change them. The steel valkyr does not need to sleep or rest for any long period of time in order to ready his maneuvers; any time he spends ten minutes meditating, he can change his readied maneuvers.

A steel valkyr begins an encounter with all his readied maneuvers unexpended, regardless of how many times he might have already used them since he chose them. When he initiates a maneuver, he expends it for the current encounter, so each of his readied maneuvers can be used once per encounter (unless he recovers them, as described below).

In order for the steel valkyr to recover maneuvers, he must perform a gambit. Alternately, the steel valkyr may channel the power of the primal song to recover a single maneuver as a standard action.

This ability replaces spellcasting
Stances

A steel valkyr begins his career with knowledge of one stance from any discipline open to steel valkyrs. At 4th, 7th, 11th, and 13th levels, he can select an additional stance to learn. The maximum level of stances gained through steel valkyr levels is limited by those listed in Table: Archetype Maneuver Progression. Unlike maneuvers, stances are not expended and the steel valkyr does not have to ready them. All the stances he knows are available to his at all times, and he can change the stance he is currently maintaining as a swift action. A stance is an extraordinary ability unless otherwise stated in the stance or discipline description.

Unlike with maneuvers, a steel valkyr cannot learn a new stance at higher levels in place of one he already knows.
Gambits (Ex)

A steel valkyr taps into his combat instincts to seize advantages in combat. At 1st level, a steel valkyr selects two gambits from the gambits available to warlords (see the warlord base class in Path of War) or the steel valkyr gambits listed below. At 4th level and every four levels thereafter, a steel valkyr selects an additional gambit to learn. Any gambit that would normally use the steel valkyr’s Charisma modifier to determine its effects instead uses his steel valkyr initiation modifier. These gambits allow the steel valkyr to recover maneuvers. Due to their reliance on the stresses of combat to bring out the best of the steel valkyr, gambits cannot be used outside combat. A gambit has two aspects: a risk and a reward. A gambit’s risk describes an action the steel valkyr must take in order to play the gambit.

The steel valkyr begin a gambit as a swift action, then performs the gambit’s risk action. He may add haf his steel valkyr initiation modifier (minimum 1) as a luck bonus on any d20 rolls made while performing this action (such as the Acrobatics check of an acrobatic gambit, or the attack roll of a brave gambit). The steel valkyr only gets this bonus if he used a swift action to begin the gambit; if taking the actions normally, he gains no additional benefits. If the steel valkyr initiates a maneuver as part of a gambit, he cannot recover that maneuver when the gambit is completed (even if it’s his only expended maneuver). If the steel valkyr succeeds at his gambit’s risk, he recovers a number of expended maneuvers equal to his steel valkyr initiation modifier (minimum 2) and gains the reward listed in the gambit’s description. Allies who would gain a benefit from the gambit’s reward must be within 60 feet of the steel valkyr and able to see him perform the gambit’s risk. If the steel valkyr fails his gambit (such as missing the charge attack of a brave gambit, or failing the saving throw of an unbreakable gambit), he suffers the gambit’s rake, recovering only a single expended maneuver and taking a –2 penalty on all d20 rolls for one round.
Raging Song

Steel valkyrs learn different performances than most skalds. A steel valkyr still learns song of marching and dirge of doom, but otherwise learns performances from the list below. A steel valkyr’s performances may all use either audible or visual components, even if they would otherwise only use one or the other.

    Warmaster’s Song: at 1st level, affected allies gain a +1 bonus on attack and damage rolls as well as a +1 bonus on the DCs of all maneuvers they initiate. These bonuses increase to +2 at 8th level and +3 at 16th level. This ability replaces Inspired Rage, but counts as it for the purpose of meeting prerequisites. Any effects that would take effect during inspired rage take effect during this song.
    Surging Song: Starting at 6th level, the steel valkyr may perform a surging song. Affected creatures may perform any of the steel valkyr’s gambits as if they also knew them. They use the steel valkyr’s Charisma modifier rather than their own when determining the effects, and do not regain maneuvers if they perform a gambit which they learned this way. This ability replaces Song of Strength
    Warpath Epic: At 14th level, the steel valkyr may perform a warpath epic. Affected creatures may expend a prepared maneuver to initiate a single maneuver of equal or lower level prepared by another affected creature. This ability replaces Song of the Fallen

Combat Performer (Ex)

At 1st level, a steel valkyr can make Perform checks in place of checks with his disciplines’ associated skills when using maneuvers. He may only substitute Perform checks for skills associated with disciplines he has access to from his steel valkyr levels (including disciplines acquired through traits or martial traditions).

This ability replaces Scribe Scroll.
Martial Lore (Ex)

At 5th level, a steel valkyr learns to draw from storied martial techniques to turn the tide in the heat of battle. Once per day, a steel valkyr can initiate any maneuver of up to a level he knows as if it were one of his maneuvers known, expending a single readied maneuver of equal level. He can do this twice per day at 11th level and three times per day at 17th level.

This ability replaces spell kenning.
Heedless Advance (Su)

At 20th level, the power of the steel valkyr’s song instills within its listeners awesome perseverance in battle. The steel valkyr may start a raging song as a free action, and affected creatures recover a single expended maneuver whenever they succeed on an attack roll. This cannot recover a boost that affected the attack roll or a maneuver which the attack roll was performed as a part of.

This ability replaces Master Skald
Steel Valkyr Gambits

Steel valkyr can select these gambits in addition to the gambits normally available to warlords. Some of these gambits are supernatural abilities, and do not function in an anti-magic field or similar effect.

Roaring Gambit (Su)

Risk: The steel valkyr attempts a perform check in place of another check (which may come from combat performer, versatile performance, or some other ability). When he does this, he adds his Charisma modifier to the perform check a second time. This ability can only be used in combat.

Reward: The steel valkyr regains 1 round of raging song. 
         */
    }
}
